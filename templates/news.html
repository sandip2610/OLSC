<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>News</title>
  <style>
    body {font-family: Georgia, 'Times New Roman', Times, serif;background: #fdfcf7;margin: 0;}
    header h1 {margin: 60px auto 30px;}
    .container {max-width: 1300px;margin: auto;padding: 20px;column-count: 2;column-gap: 20px;}
    @media (max-width: 768px) {
      .container {column-count: 1;}
    }
    .news-card {display: inline-block;background: #fff;margin: 0 0 20px;padding: 15px;border: 1px solid #ddd;width: 100%;box-sizing: border-box;break-inside: avoid;transition: 0.3s;cursor: pointer;}
    .news-card:hover {background: #f9f9f9;transform: scale(1.01);}
    .news-card img {width: 100%;height: 500px;margin-bottom: 12px;border-radius: 5px;}
    .date {font-size: 0.8rem;color: #777;margin-bottom: 8px;font-style: italic;}
    .news-card h3 {font-size: 1.3rem;color: #222;margin: 0 0 10px;}
    .news-card p {font-size: 1rem;color: #333;text-align: justify;}
    .container.full-view {column-count: 1;}
    .news-card.full {
      width: 100%;
      display: block;
      font-size: 1.1rem;
    }
    .hide {display: none;}
    .back-btn {display: inline-block;margin-bottom: 15px;padding: 6px 12px;background: #333;color: #fff;text-decoration: none;border-radius: 4px;cursor: pointer;}
    .back-btn:hover {background: #555;}
  </style>
</head>
<body>
{% extends 'header.html' %}
{% block title %}News | Blogrator Academy{% endblock %}
{% block content %}
  <header>
    <h1 align="center">News</h1>
  </header>
  <div class="container" id="newsContainer">
    {% for news in news_items %}
      <div class="news-card" onclick="openNews(this)">
        {% if news.image %}
          <img src="{{ news.image.url }}" alt="{{ news.title }}">
        {% endif %}
        <div class="date">{{ news.created_at|date:"F d, Y" }}</div>
        <h3>{{ news.title }}</h3>
        <p>{{ news.description|truncatechars:250 }}</p>
        <div class="full-content" style="display:none;">
          <p>{{ news.description }}</p>
        </div>
      </div>
    {% empty %}
      <p>No news available.</p>
    {% endfor %}
  </div>
  <script>
    function openNews(card) {
      const container = document.getElementById("newsContainer");
      const cards = container.querySelectorAll(".news-card");
      cards.forEach(c => {
        if (c !== card) {
          c.classList.add("hide");
        }
      });
      card.classList.add("full");
      container.classList.add("full-view");
      card.querySelector(".full-content").style.display = "block";
      if (!card.querySelector(".back-btn")) {
        const backBtn = document.createElement("button");
        backBtn.innerText = "← Back to all news";
        backBtn.className = "back-btn";
        backBtn.onclick = function(e) {
          e.stopPropagation();
          resetView();
        };
        card.insertBefore(backBtn, card.firstChild);
      }
    }
    function resetView() {
      const container = document.getElementById("newsContainer");
      const cards = container.querySelectorAll(".news-card");

      cards.forEach(c => {
        c.classList.remove("hide", "full");
        c.querySelector(".full-content").style.display = "none";
        const backBtn = c.querySelector(".back-btn");
        if (backBtn) backBtn.remove();
      });
      container.classList.remove("full-view");
    }
  </script>
{% endblock %}
</body>
</html>